# -*- coding: utf-8 -*-
"""AUSRP.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/13ZKS2F5N30AnmnQgttD_jQjCWOkOms1C
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score

df=pd.read_csv("weatherAUS.csv")
df['Cloud3pm']=df['Cloud3pm'].fillna(0)
df['Cloud9am']=df['Cloud9am'].fillna(0)
df['Evaporation']=df['Evaporation'].fillna(0)
df['Sunshine']=df['Sunshine'].fillna(0)
df['MinTemp']=df['MinTemp'].fillna(0)
df['MaxTemp']=df['MaxTemp'].fillna(0)
df['WindGustSpeed']=df['WindGustSpeed'].fillna(0)
df=df.dropna(how='any')
df=df.drop(columns=['Date'])
df

from sklearn.preprocessing import LabelEncoder
le1=LabelEncoder()
le2=LabelEncoder()
le3=LabelEncoder()
df['Location']=le1.fit_transform(df['Location'])
df['WindGustDir']=le2.fit_transform(df['WindGustDir'])
df['WindDir9am']=le2.fit_transform(df['WindDir9am'])
df['WindDir3pm']=le2.fit_transform(df['WindDir3pm'])
df['RainToday']=le3.fit_transform(df['RainToday'])
df['RainTomorrow']=le3.fit_transform(df['RainTomorrow'])
df['Rain prediction']=((df['RainToday']+df['RainTomorrow'])/2).astype(int)
df

X=df.iloc[:,:-1].values
y=df.iloc[:,-1].values

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)

model=MLPClassifier(alpha=0.01, batch_size=256, epsilon=1e-08, learning_rate='adaptive', max_iter=500)
model.fit(X_train,y_train)

res = model.predict(X_test)
res=np.round(res)
np.set_printoptions(precision=2)
print(res)

print("Accuracy Score for the algorithm=>{}%".format(round(accuracy_score(y_test,res)*100),2))